<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Notificaciones Push</title>
</head>
<body>
    <button id="subscribe-btn">Activar notificaciones</button>
    <script>
        // Registrar el Service Worker
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/service-worker.js')
                .then(function (registration) {
                    alert('Service Worker registrado con éxito.');
                })
                .catch(function (error) {
                    alert('Error al registrar el Service Worker: ' + error);
                });
        }

        // Suscribir al usuario
        document.getElementById('subscribe-btn').addEventListener('click', function () {
            if ('Notification' in window && 'PushManager' in window) {
                Notification.requestPermission().then(function (permission) {
                    if (permission === 'granted') {
                        navigator.serviceWorker.ready.then(function (registration) {
                            registration.pushManager.subscribe({
                                userVisibleOnly: true,
                                applicationServerKey: 'BJiOyJkuBpbpGBsiLKOqPcYP3eEnypNoWOrh69R59rGGw88yMl3ex03UTdiysQwvxfpzHPF-5aQjWxNsFGYoz-o' // Tu clave pública VAPID
                            }).then(function (subscription) {
                                alert('Usuario suscrito: ' + JSON.stringify(subscription));
                                // Envía los datos de suscripción al servidor (PHP)
                                
                            });
                        });
                    }
                });
            } else {
                alert('Tu navegador no soporta notificaciones push.');
            }
        });
    </script>
</body>
</html>
